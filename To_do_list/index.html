<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To_do_List</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .calendar-day.today {
            background-color: #EFF6FF;
            color: #3B82F6;
            font-weight: 600;
        }
        .calendar-day.selected {
            background-color: #3B82F6;
            color: white;
        }
        .todo-count {
            font-size: 0.7rem;
            background-color: #E5E7EB;
            color: #4B5563;
            padding: 0.1rem 0.3rem;
            border-radius: 0.5rem;
            position: absolute;
            bottom: 0.2rem;
            right: 0.2rem;
            transform: translate(25%, 25%);
        }
        .calendar-day.selected .todo-count {
            background-color: #2563EB;
            color: white;
        }
        .calendar-day.today .todo-count {
            background-color: #93C5FD;
            color: #1E40AF;
        }
        .calendar-day {
            position: relative;
            min-height: 3rem;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-12">
        <div class="max-w-md mx-auto bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl p-8 border border-white/20">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-8 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">To_Do_List</h1>
            
            <!-- 캘린더 위 날짜 및 이동 버튼 -->
            <div class="flex items-center justify-center gap-2 mb-4">
                <button id="prevMonth" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5 5-5" />
                    </svg>
                </button>
                <button id="prevDate" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <span id="calendarHeaderDate" class="text-lg font-semibold text-gray-800 px-4"></span>
                <button id="nextDate" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                </button>
                <button id="nextMonth" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5-5 5" />
                    </svg>
                </button>
            </div>

            <!-- 달력 -->
            <div class="mb-6 bg-white rounded-xl shadow-sm p-4">
                <div class="grid grid-cols-7 gap-1 text-center text-sm text-gray-500 mb-2">
                    <div>일</div>
                    <div>월</div>
                    <div>화</div>
                    <div>수</div>
                    <div>목</div>
                    <div>금</div>
                    <div>토</div>
                </div>
                <div id="calendarDays" class="grid grid-cols-7 gap-1">
                    <!-- 달력 날짜들이 여기에 동적으로 추가됩니다 -->
                </div>
            </div>

            <!-- 입력 폼 -->
            <form id="todoForm" class="mb-8">
                <div class="flex gap-3">
                    <input type="text" 
                           id="todoInput"
                           placeholder="할 일을 입력하세요" 
                           class="flex-1 px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent shadow-sm transition-all duration-200">
                    <button type="submit" 
                            class="px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl hover:from-blue-600 hover:to-indigo-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5">
                        추가
                    </button>
                </div>
            </form>

            <!-- Todo 리스트 -->
            <ul id="todoList" class="space-y-4">
                <!-- Todo 아이템들이 여기에 동적으로 추가됩니다 -->
            </ul>
        </div>
    </div>

    <script>
        // 전역 변수로 현재 선택된 날짜 관리
        let selectedDate = new Date();
        let currentMonth = new Date();

        // 날짜를 YYYY-MM-DD 형식의 문자열로 변환하는 함수
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // 날짜 및 요일을 캘린더 헤더에 표시하는 함수
        function updateCalendarHeader() {
            const year = selectedDate.getFullYear();
            const month = selectedDate.getMonth() + 1;
            const date = selectedDate.getDate();
            const days = ['일', '월', '화', '수', '목', '금', '토'];
            const day = days[selectedDate.getDay()];
            document.getElementById('calendarHeaderDate').textContent = `${year}년 ${month}월 ${date}일 (${day})`;
        }

        // 기존 updateDate 함수에서 날짜/요일 표시 부분 제거, updateCalendarHeader 호출 추가
        function updateDate() {
            // 날짜가 변경될 때마다 해당 날짜의 할 일 목록을 표시
            displayTodos();
            updateCalendar();
            updateCalendarHeader();
        }

        // 달력 업데이트 함수
        function updateCalendar() {
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startingDay = firstDay.getDay();
            const totalDays = lastDay.getDate();

            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';

            // 이전 달의 날짜들
            for (let i = 0; i < startingDay; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'p-2 text-gray-400';
                calendarDays.appendChild(dayElement);
            }

            // 현재 달의 날짜들
            const today = new Date();
            for (let i = 1; i <= totalDays; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day p-2 text-center cursor-pointer hover:bg-gray-100 rounded-lg transition-colors duration-200';
                
                // 날짜 숫자
                const dateNumber = document.createElement('div');
                dateNumber.textContent = i;
                dayElement.appendChild(dateNumber);

                // 해당 날짜의 할 일 개수 표시
                const currentDate = new Date(year, month, i);
                const dateKey = formatDate(currentDate);
                const todos = JSON.parse(localStorage.getItem(dateKey) || '[]');
                if (todos.length > 0) {
                    const todoCount = document.createElement('div');
                    todoCount.className = 'todo-count';
                    todoCount.textContent = todos.length;
                    dayElement.appendChild(todoCount);
                }
                
                // 오늘 날짜 체크
                if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                    dayElement.classList.add('today');
                }
                
                // 선택된 날짜 체크
                if (i === selectedDate.getDate() && month === selectedDate.getMonth() && year === selectedDate.getFullYear()) {
                    dayElement.classList.add('selected');
                }

                dayElement.addEventListener('click', () => {
                    selectedDate = new Date(year, month, i);
                    updateDate();
                });
                calendarDays.appendChild(dayElement);
            }
        }

        // 할 일을 로컬 스토리지에 저장하는 함수
        function saveTodo(todoText) {
            const dateKey = formatDate(selectedDate);
            const todos = JSON.parse(localStorage.getItem(dateKey) || '[]');
            todos.push({
                id: Date.now(),
                text: todoText,
                completed: false
            });
            localStorage.setItem(dateKey, JSON.stringify(todos));
            displayTodos();
        }

        // 할 일 목록을 화면에 표시하는 함수
        function displayTodos() {
            const dateKey = formatDate(selectedDate);
            const todos = JSON.parse(localStorage.getItem(dateKey) || '[]');
            const todoList = document.getElementById('todoList');
            todoList.innerHTML = '';

            todos.forEach(todo => {
                const li = document.createElement('li');
                li.className = 'group flex items-center justify-between p-4 bg-white/50 backdrop-blur-sm rounded-xl shadow-sm hover:shadow-md transition-all duration-200 border border-gray-100';
                li.innerHTML = `
                    <div class="flex items-center gap-4">
                        <input type="checkbox" 
                               class="w-5 h-5 text-blue-500 rounded-lg focus:ring-blue-500 border-gray-300"
                               ${todo.completed ? 'checked' : ''}>
                        <span class="text-gray-700 font-medium ${todo.completed ? 'line-through text-gray-400' : ''}">${todo.text}</span>
                    </div>
                    <button class="text-gray-400 hover:text-red-500 transition-colors duration-200 opacity-0 group-hover:opacity-100">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                        </svg>
                    </button>
                `;

                // 체크박스 이벤트 리스너
                const checkbox = li.querySelector('input[type="checkbox"]');
                checkbox.addEventListener('change', () => {
                    todo.completed = checkbox.checked;
                    localStorage.setItem(dateKey, JSON.stringify(todos));
                    displayTodos();
                });

                // 삭제 버튼 이벤트 리스너
                const deleteBtn = li.querySelector('button');
                deleteBtn.addEventListener('click', () => {
                    const index = todos.findIndex(t => t.id === todo.id);
                    todos.splice(index, 1);
                    localStorage.setItem(dateKey, JSON.stringify(todos));
                    displayTodos();
                });

                todoList.appendChild(li);
            });
        }

        // 폼 제출 이벤트 리스너
        document.getElementById('todoForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const input = document.getElementById('todoInput');
            const todoText = input.value.trim();
            
            if (todoText) {
                saveTodo(todoText);
                input.value = '';
            }
        });

        // 버튼 이벤트 리스너 연결
        document.getElementById('prevMonth').addEventListener('click', () => {
            currentMonth.setMonth(currentMonth.getMonth() - 1);
            // 월이 바뀌면 selectedDate도 해당 월 1일로 이동
            selectedDate = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            updateDate();
        });
        document.getElementById('nextMonth').addEventListener('click', () => {
            currentMonth.setMonth(currentMonth.getMonth() + 1);
            selectedDate = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            updateDate();
        });
        document.getElementById('prevDate').addEventListener('click', () => {
            selectedDate.setDate(selectedDate.getDate() - 1);
            // 월이 바뀌면 currentMonth도 맞춰줌
            currentMonth = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), 1);
            updateDate();
        });
        document.getElementById('nextDate').addEventListener('click', () => {
            selectedDate.setDate(selectedDate.getDate() + 1);
            currentMonth = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), 1);
            updateDate();
        });

        // 초기화
        updateDate();
        updateCalendarHeader();
    </script>
</body>
</html> 